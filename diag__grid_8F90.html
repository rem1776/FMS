<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FMS: diag_manager/diag_grid.F90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FMS
   &#160;<span id="projectnumber">@VERSION@</span>
   </div>
   <div id="projectbrief">FMS Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('diag__grid_8F90.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">diag_grid.F90 File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>diag_grid_mod is a set of procedures to work with the model's global grid to allow regional output.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;file_version.h&gt;</code><br />
</div>
<p><a href="diag__grid_8F90_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Types</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdiag__grid__mod_1_1diag__global__grid__type.html">diag_global_grid_type</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Contains the model's global grid data, and other grid information.  <a href="structdiag__grid__mod_1_1diag__global__grid__type.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdiag__grid__mod_1_1point.html">point</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Private point type to hold the (x,y,z) location for a (lat,lon) location.  <a href="structdiag__grid__mod_1_1point.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a344fd60b0703604265c527332794df35"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="diag__grid_8F90.html#a344fd60b0703604265c527332794df35">diag_grid_init</a> (domain, glo_lat, glo_lon, aglo_lat, aglo_lon)</td></tr>
<tr class="memdesc:a344fd60b0703604265c527332794df35"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send the global grid to the <code>diag_manager_mod</code> for regional output. @description In order for the diag_manager to do regional output for grids other than the standard lat/lon grid, the <code> diag_manager_mod</code> needs to know the the latitude and longitude values for the entire global grid. This procedure is the mechanism the models will use to share their grid with the diagnostic manager. This procedure needs to be called after the grid is created, and before the first call to register the fields.  <a href="diag__grid_8F90.html#a344fd60b0703604265c527332794df35">More...</a><br /></td></tr>
<tr class="separator:a344fd60b0703604265c527332794df35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e5a7eeabed97e40f69b0167e44b1330"><td class="memItemLeft" align="right" valign="top"><a id="a5e5a7eeabed97e40f69b0167e44b1330"></a>
subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="diag__grid_8F90.html#a5e5a7eeabed97e40f69b0167e44b1330">diag_grid_end</a> ()</td></tr>
<tr class="memdesc:a5e5a7eeabed97e40f69b0167e44b1330"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unallocate the diag_global_grid variable. @description The <code>diag_global_grid</code> variable is only needed during the register field calls, and then only if there are fields requestion regional output. Once all the register fields calls are complete (before the first <code>send_data</code> call this procedure can be called to free up memory. <br /></td></tr>
<tr class="separator:a5e5a7eeabed97e40f69b0167e44b1330"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd48f9784c8244ff7edc7c98f1ad51cd"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="diag__grid_8F90.html#acd48f9784c8244ff7edc7c98f1ad51cd">get_local_indexes</a> (latStart, latEnd, lonStart, lonEnd, istart, iend, jstart, jend)</td></tr>
<tr class="memdesc:acd48f9784c8244ff7edc7c98f1ad51cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find the local start and local end indexes on the local PE for regional output. @description Given a defined region, find the local indexes on the local PE surrounding the region.  <a href="diag__grid_8F90.html#acd48f9784c8244ff7edc7c98f1ad51cd">More...</a><br /></td></tr>
<tr class="separator:acd48f9784c8244ff7edc7c98f1ad51cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8809db19aeaef7fbd8a30a94017a45af"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="diag__grid_8F90.html#a8809db19aeaef7fbd8a30a94017a45af">get_local_indexes2</a> (lat, lon, iindex, jindex)</td></tr>
<tr class="memdesc:a8809db19aeaef7fbd8a30a94017a45af"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find the indices of the nearest grid point of the a-grid to the specified (lon,lat) location on the local PE. if desired point not within domain of local PE, return (0,0) as the indices.  <a href="diag__grid_8F90.html#a8809db19aeaef7fbd8a30a94017a45af">More...</a><br /></td></tr>
<tr class="separator:a8809db19aeaef7fbd8a30a94017a45af"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a53e348963b34cc198fb5dcf065d7fcc5"><td class="memItemLeft" align="right" valign="top"><a id="a53e348963b34cc198fb5dcf065d7fcc5"></a>
type(diag_global_grid_type)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="diag__grid_8F90.html#a53e348963b34cc198fb5dcf065d7fcc5">diag_global_grid</a></td></tr>
<tr class="memdesc:a53e348963b34cc198fb5dcf065d7fcc5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Variable to hold the global grid data. <br /></td></tr>
<tr class="separator:a53e348963b34cc198fb5dcf065d7fcc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b81ca171d240b2f550afcb9f8cbccdc"><td class="memItemLeft" align="right" valign="top"><a id="a5b81ca171d240b2f550afcb9f8cbccdc"></a>
logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="diag__grid_8F90.html#a5b81ca171d240b2f550afcb9f8cbccdc">diag_grid_initialized</a> = .FALSE.</td></tr>
<tr class="memdesc:a5b81ca171d240b2f550afcb9f8cbccdc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Indicates if the diag_grid_mod has been initialized. <br /></td></tr>
<tr class="separator:a5b81ca171d240b2f550afcb9f8cbccdc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>diag_grid_mod is a set of procedures to work with the model's global grid to allow regional output. </p>
<dl class="section author"><dt>Author</dt><dd>Seth Underwood @email <a href="#" onclick="location.href='mai'+'lto:'+'gfd'+'l.'+'cli'+'ma'+'te.'+'mo'+'del'+'.i'+'nfo'+'@n'+'oaa'+'.g'+'ov'; return false;">gfdl.<span style="display: none;">.nosp@m.</span>clim<span style="display: none;">.nosp@m.</span>ate.m<span style="display: none;">.nosp@m.</span>odel<span style="display: none;">.nosp@m.</span>.info<span style="display: none;">.nosp@m.</span>@noa<span style="display: none;">.nosp@m.</span>a.gov</a> @description TT&gt;diag_grid_mod contains useful utilities for dealing with, mostly, regional output for grids other than the standard lat/lon grid. This module contains three public procedures <code> diag_grid_init</code>, which is shared globably in the <code> diag_manager_mod</code>, <code>diag_grid_end</code> which will free up memory used during the register field calls, and <code>get_local_indexes</code>. The <code>send_global_grid</code> procedure is called by the model that creates the global grid. <code>send_global_grid</code> needs to be called before any fields are registered that will output only regions. <code>get_local_indexes</code> is to be called by the <code>diag_manager_mod</code> to discover the global indexes defining a subregion on the tile. </dd></dl>

<p class="definition">Definition in file <a class="el" href="diag__grid_8F90_source.html">diag_grid.F90</a>.</p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a344fd60b0703604265c527332794df35"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a344fd60b0703604265c527332794df35">&#9670;&nbsp;</a></span>diag_grid_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public diag_grid_mod::diag_grid_init </td>
          <td>(</td>
          <td class="paramtype">type(domain2d), intent(in)&#160;</td>
          <td class="paramname"><em>domain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>glo_lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>glo_lon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>aglo_lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>aglo_lon</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send the global grid to the <code>diag_manager_mod</code> for regional output. @description In order for the diag_manager to do regional output for grids other than the standard lat/lon grid, the <code> diag_manager_mod</code> needs to know the the latitude and longitude values for the entire global grid. This procedure is the mechanism the models will use to share their grid with the diagnostic manager. This procedure needs to be called after the grid is created, and before the first call to register the fields. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">domain</td><td>The domain to which the grid data corresponds. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">glo_lat</td><td>The latitude information for the grid tile. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">glo_lon</td><td>The longitude information for the grid tile. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">aglo_lat</td><td>The latitude information for the a-grid tile. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">aglo_lon</td><td>The longitude information for the a-grid tile. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="diag__grid_8F90_source.html#l00162">162</a> of file <a class="el" href="diag__grid_8F90_source.html">diag_grid.F90</a>.</p>

</div>
</div>
<a id="acd48f9784c8244ff7edc7c98f1ad51cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd48f9784c8244ff7edc7c98f1ad51cd">&#9670;&nbsp;</a></span>get_local_indexes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public diag_grid_mod::get_local_indexes </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>latStart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>latEnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>lonStart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>lonEnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>istart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>iend</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>jstart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>jend</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find the local start and local end indexes on the local PE for regional output. @description Given a defined region, find the local indexes on the local PE surrounding the region. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">latstart</td><td>lat start angles </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lonstart</td><td>lon start angles </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">latend</td><td>lat end angles </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lonend</td><td>lon end angles </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">istart</td><td>i start indexes </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">jstart</td><td>j start indexes </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">iend</td><td>i end indexes </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">jend</td><td>j end indexes </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="diag__grid_8F90_source.html#l00366">366</a> of file <a class="el" href="diag__grid_8F90_source.html">diag_grid.F90</a>.</p>

</div>
</div>
<a id="a8809db19aeaef7fbd8a30a94017a45af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8809db19aeaef7fbd8a30a94017a45af">&#9670;&nbsp;</a></span>get_local_indexes2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public diag_grid_mod::get_local_indexes2 </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>lon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>iindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>jindex</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find the indices of the nearest grid point of the a-grid to the specified (lon,lat) location on the local PE. if desired point not within domain of local PE, return (0,0) as the indices. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">lat</td><td>lat location </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lon</td><td>lon location </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">iindex</td><td>i indexes </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">jindex</td><td>j indexes </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="diag__grid_8F90_source.html#l00616">616</a> of file <a class="el" href="diag__grid_8F90_source.html">diag_grid.F90</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_3bcd401efd066c65ba4cd49d381fb5da.html">diag_manager</a></li><li class="navelem"><a class="el" href="diag__grid_8F90.html">diag_grid.F90</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
