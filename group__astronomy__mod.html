<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FMS: astronomy_mod</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FMS
   </div>
   <div id="projectbrief">FMS Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('group__astronomy__mod.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">astronomy_mod<div class="ingroups"><a class="el" href="group__astronomy.html">Astronomy</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Provides astronomical variables for use by other modules within fms. The only currently used interface is for determination of astronomical values needed by the shortwave radiation packages.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:ga28a67f4da82725afd9c0051464b8767c"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#ga28a67f4da82725afd9c0051464b8767c">astronomy_init</a> (latb, lonb)</td></tr>
<tr class="memdesc:ga28a67f4da82725afd9c0051464b8767c"><td class="mdescLeft">&#160;</td><td class="mdescRight">astronomy_init is the constructor for astronomy_mod.  <a href="group__astronomy__mod.html#ga28a67f4da82725afd9c0051464b8767c">More...</a><br /></td></tr>
<tr class="separator:ga28a67f4da82725afd9c0051464b8767c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga58ff2b69c33ae8d00c831b2b049e4573"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#ga58ff2b69c33ae8d00c831b2b049e4573">set_orbital_parameters</a> (ecc_in, obliq_in, per_in)</td></tr>
<tr class="memdesc:ga58ff2b69c33ae8d00c831b2b049e4573"><td class="mdescLeft">&#160;</td><td class="mdescRight">set_orbital_parameters saves the input values of eccentricity, obliquity and perihelion time as module variables for use by astronomy_mod.  <a href="group__astronomy__mod.html#ga58ff2b69c33ae8d00c831b2b049e4573">More...</a><br /></td></tr>
<tr class="separator:ga58ff2b69c33ae8d00c831b2b049e4573"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3878ea3f081f4d89f7f19bd530767897"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#ga3878ea3f081f4d89f7f19bd530767897">get_orbital_parameters</a> (ecc_out, obliq_out, per_out)</td></tr>
<tr class="memdesc:ga3878ea3f081f4d89f7f19bd530767897"><td class="mdescLeft">&#160;</td><td class="mdescRight">get_orbital_parameters retrieves the orbital parameters for use by another module.  <a href="group__astronomy__mod.html#ga3878ea3f081f4d89f7f19bd530767897">More...</a><br /></td></tr>
<tr class="separator:ga3878ea3f081f4d89f7f19bd530767897"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga58c5837e3f38565db2c7901d880950f7"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#ga58c5837e3f38565db2c7901d880950f7">set_ref_date_of_ae</a> (day_in, month_in, year_in, second_in, minute_in, hour_in)</td></tr>
<tr class="memdesc:ga58c5837e3f38565db2c7901d880950f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">set_ref_date_of_ae provides a means of specifying the reference date of the NH autumnal equinox for a particular year.  <a href="group__astronomy__mod.html#ga58c5837e3f38565db2c7901d880950f7">More...</a><br /></td></tr>
<tr class="separator:ga58c5837e3f38565db2c7901d880950f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gada396fa1ede7431df75438a6c9d6c771"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#gada396fa1ede7431df75438a6c9d6c771">get_ref_date_of_ae</a> (day_out, month_out, year_out, second_out, minute_out, hour_out)</td></tr>
<tr class="memdesc:gada396fa1ede7431df75438a6c9d6c771"><td class="mdescLeft">&#160;</td><td class="mdescRight">get_ref_date_of_ae retrieves the reference date of the autumnal equinox as integer variables.  <a href="group__astronomy__mod.html#gada396fa1ede7431df75438a6c9d6c771">More...</a><br /></td></tr>
<tr class="separator:gada396fa1ede7431df75438a6c9d6c771"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1cbb745900e141cfee7e422a2f02caa1"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#ga1cbb745900e141cfee7e422a2f02caa1">astronomy_end</a></td></tr>
<tr class="memdesc:ga1cbb745900e141cfee7e422a2f02caa1"><td class="mdescLeft">&#160;</td><td class="mdescRight">astronomy_end is the destructor for astronomy_mod.  <a href="group__astronomy__mod.html#ga1cbb745900e141cfee7e422a2f02caa1">More...</a><br /></td></tr>
<tr class="separator:ga1cbb745900e141cfee7e422a2f02caa1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7fb404a6aa92465cf74a3fd4a5c48d37"><td class="memItemLeft" align="right" valign="top">real function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#ga7fb404a6aa92465cf74a3fd4a5c48d37">orbital_time</a> (time)</td></tr>
<tr class="memdesc:ga7fb404a6aa92465cf74a3fd4a5c48d37"><td class="mdescLeft">&#160;</td><td class="mdescRight">Orbital time returns the time (1 year = 2*pi) since autumnal equinox.  <a href="group__astronomy__mod.html#ga7fb404a6aa92465cf74a3fd4a5c48d37">More...</a><br /></td></tr>
<tr class="separator:ga7fb404a6aa92465cf74a3fd4a5c48d37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa2cc4e0964e5251d056c4f05c4a8ddf7"><td class="memItemLeft" align="right" valign="top">real function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__astronomy__mod.html#gaa2cc4e0964e5251d056c4f05c4a8ddf7">universal_time</a> (time)</td></tr>
<tr class="memdesc:gaa2cc4e0964e5251d056c4f05c4a8ddf7"><td class="mdescLeft">&#160;</td><td class="mdescRight">universal_time returns the time of day at longitude = 0.0 (1 day = 2*pi)  <a href="group__astronomy__mod.html#gaa2cc4e0964e5251d056c4f05c4a8ddf7">More...</a><br /></td></tr>
<tr class="separator:gaa2cc4e0964e5251d056c4f05c4a8ddf7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Provides astronomical variables for use by other modules within fms. The only currently used interface is for determination of astronomical values needed by the shortwave radiation packages. </p>
<dl class="section author"><dt>Author</dt><dd>Fei Liu <a class="el" href="">gfdl.climate.model.info@noaa.gov</a></dd></dl>


<h3><a id="daily_mean_solar"></a>daily_mean_solar Interface</h3><div class="textblock"><div class="fragment"><div class="line"><span class="keyword">call </span>daily_mean_solar (lat, time, cosz, fracday, rrsun)</div>
<div class="line"><span class="keyword">call </span>daily_mean_solar (lat, time_since_ae, cosz, fracday, rrsun)</div>
<div class="line"><span class="keyword">call </span>daily_mean_solar (lat, time, cosz, solar)</div>
<div class="line"><span class="keyword">call </span>daily_mean_solar (lat, time_since_ae, cosz, solar)</div>
</div><!-- fragment -->The first option (used in conjunction with time_manager_mod) generates the real variable time_since_ae from the time_type input time, and then calls daily_mean_solar with this real input (option 2). The third and fourth options correspond to the first and second and are used with then spectral 2-layer model, where only cosz and solar are desired as output. These routines generate dummy arguments and then call option 2, where the calculation is done.The time of year is set by </p><div class="fragment"><div class="line"><span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span> :: time_since_ae</div>
</div><!-- fragment --><p> With time_type input, the time of year is extracted from </p><div class="fragment"><div class="line"><span class="keywordtype">type</span>(time_type), <span class="keywordtype">intent(in)</span> :: time</div>
</div><!-- fragment -->Separate routines exist within this interface for scalar, 1D or 2D input and output fields:<div class="fragment"><div class="line"><span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(:,:)</span> :: lat</div>
<div class="line"><span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(:)</span>   :: lat</div>
<div class="line"><span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span>                 :: lat</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">real</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">dimension(:,:)</span> :: cosz, fracday</div>
<div class="line"><span class="keywordtype">real</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">dimension(:)</span>   :: cosz, fracday</div>
<div class="line"><span class="keywordtype">real</span>, <span class="keywordtype">intent(out)</span>                 :: cosz, fracday</div>
</div><!-- fragment --><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;lat&gt;</td><td>Latitudes of model grid points [radians] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;time_since_ae&gt;</td><td>Time of year; autumnal equinox = 0.0, one year = 2 * pi [radians] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;time&gt;</td><td>Time at which astronomical values are desired (time_type variable) [seconds, days] </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;cosz&gt;</td><td>Cosine of solar zenith angle, set to zero when entire period is in darkness [dimensionless] </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;fracday&gt;</td><td>Daylight fraction of time interval [dimensionless] </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;rrsun&gt;</td><td>Earth-Sun distance (r) relative to semi-major axis of orbital ellipse (a):(a/r)**2 [dimensionless] </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;solar&gt;</td><td>shortwave flux factor: cosine of zenith angle * daylight fraction / (earth-sun distance squared) [dimensionless] </td></tr>
  </table>
  </dd>
</dl>
</div>

<h3><a id="get_period"></a>get_period Interface</h3><div class="textblock"><div class="fragment"><div class="line"><span class="keyword">call </span>get_period (period)</div>
</div><!-- fragment -->Separate routines exist within this interface for integer and time_type output:<div class="fragment"><div class="line"><span class="keywordtype">integer</span>, <span class="keywordtype">intent(out)</span>         :: period</div>
<div class="line"><span class="keywordtype">type</span>(time_type), <span class="keywordtype">intent(out)</span> :: period</div>
</div><!-- fragment --><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;period_out&gt;</td><td>Length of year for calendar in use </td></tr>
  </table>
  </dd>
</dl>
</div>

<h3><a id="set_period"></a>set_period Interface</h3><div class="textblock"><div class="fragment"><div class="line"><span class="keyword">call </span>set_period (period_in)</div>
</div><!-- fragment -->Separate routines exist within this interface for integer and time_type output:<div class="fragment"><div class="line"><span class="keywordtype">integer</span>, <span class="keywordtype">intent(out)</span>         :: period_in</div>
<div class="line"><span class="keywordtype">type</span>(time_type), <span class="keywordtype">intent(out)</span> :: period_in</div>
</div><!-- fragment --><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;period_in&gt;</td><td>Length of year for calendar in use </td></tr>
  </table>
  </dd>
</dl>
</div>

<h3><a id="half_day"></a>half_day Interface</h3><div class="textblock"><div class="fragment"><div class="line">half_day(latitude, dec) result(h)</div>
</div><!-- fragment -->Separate routines exist within this interface for scalar, or 2D input and output fields:<div class="fragment"><div class="line"><span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(:,:)</span> :: latitude</div>
<div class="line"><span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span>                 :: latitude</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">real</span>, <span class="keywordtype">dimension(size(latitude,1),size(latitude,2))</span>  :: h</div>
<div class="line"><span class="keywordtype">real</span>                                                :: h</div>
</div><!-- fragment --><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;latitude&gt;</td><td>Latitudes of model grid points [radians] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;dec&gt;</td><td>Solar declination [radians] </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;h&gt;</td><td>Half of the length of daylight at the given latitude and orbital position (dec); value ranges between 0 (all darkness) and pi (all daylight) [dimensionless] </td></tr>
  </table>
  </dd>
</dl>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="ga1cbb745900e141cfee7e422a2f02caa1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1cbb745900e141cfee7e422a2f02caa1">&#9670;&nbsp;</a></span>astronomy_end()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public astronomy_mod::astronomy_end</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>astronomy_end is the destructor for astronomy_mod. </p>
<p>check if the module has been initialized.</p>
<p>deallocate module variables.</p>
<p>mark the module as uninitialized.</p>

<p class="definition">Definition at line <a class="el" href="astronomy_8F90_source.html#l01955">1955</a> of file <a class="el" href="astronomy_8F90_source.html">astronomy.F90</a>.</p>

</div>
</div>
<a id="ga28a67f4da82725afd9c0051464b8767c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga28a67f4da82725afd9c0051464b8767c">&#9670;&nbsp;</a></span>astronomy_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public astronomy_mod::astronomy_init </td>
          <td>(</td>
          <td class="paramtype">real, dimension(:,:), intent(in), optional&#160;</td>
          <td class="paramname"><em>latb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in), optional&#160;</td>
          <td class="paramname"><em>lonb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>astronomy_init is the constructor for astronomy_mod. </p>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">FATAL,astronomy_mod ecc must be between 0 and 0.99</td><td></td></tr>
    <tr><td class="paramname">FATAL,astronomy_mod obliquity must be between -90 and 90 degrees</td><td></td></tr>
    <tr><td class="paramname">FATAL,astronomy_mod perihelion must be between 0 and 360 degrees</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">latb</td><td>2d array of model latitudes at cell corners [radians] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lonb</td><td>2d array of model longitudes at cell corners [radians] </td></tr>
  </table>
  </dd>
</dl>
<p>Verify that modules used by this module have been initialized.</p>
<p>Read namelist.</p>
<p>Write version number and namelist to logfile.</p>
<p>Be sure input values are within valid ranges.</p>
<p>Set up time-type variable defining specified time of autumnal equinox.</p>
<p>Set up time-type variable defining length of year.</p>
<p>Define useful module variables.</p>
<p>Call orbit to define table of orbital angles as function of orbital time.</p>
<p>If annual mean radiation is desired, then latb will be present. allocate arrays to hold the needed astronomical factors. define the total number of points that the processor is responsible for.</p>
<p>Mark the module as initialized.</p>

<p class="definition">Definition at line <a class="el" href="astronomy_8F90_source.html#l00398">398</a> of file <a class="el" href="astronomy_8F90_source.html">astronomy.F90</a>.</p>

</div>
</div>
<a id="ga3878ea3f081f4d89f7f19bd530767897"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3878ea3f081f4d89f7f19bd530767897">&#9670;&nbsp;</a></span>get_orbital_parameters()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public astronomy_mod::get_orbital_parameters </td>
          <td>(</td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>ecc_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>obliq_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>per_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>get_orbital_parameters retrieves the orbital parameters for use by another module. </p>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">FATAL,astronomy_mod module has not been initialized</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">ecc_out</td><td>Eccentricity of orbital ellipse [dimensionless] </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">obliq_out</td><td>Obliquity [degrees] </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">per_out</td><td>Longitude of perihelion with respect to autumnal equinox in northern hemisphere [degrees] </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="astronomy_8F90_source.html#l00658">658</a> of file <a class="el" href="astronomy_8F90_source.html">astronomy.F90</a>.</p>

</div>
</div>
<a id="gada396fa1ede7431df75438a6c9d6c771"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gada396fa1ede7431df75438a6c9d6c771">&#9670;&nbsp;</a></span>get_ref_date_of_ae()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public astronomy_mod::get_ref_date_of_ae </td>
          <td>(</td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>day_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>month_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>year_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>second_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>minute_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>hour_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>get_ref_date_of_ae retrieves the reference date of the autumnal equinox as integer variables. </p>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">FATAL,astronomy_mod module has not been initialized</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;day_out&gt;</td><td>Day of reference autumnal equinox </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;month_out&gt;</td><td>Month of reference autumnal equinox </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;year_out&gt;</td><td>Year of reference autumnal equinox </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;second_out&gt;</td><td>Second of reference autumnal equinox </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;minute_out&gt;</td><td>Minute of reference autumnal equinox </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;hour_out&gt;</td><td>Hour of reference autumnal equinox </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="astronomy_8F90_source.html#l00759">759</a> of file <a class="el" href="astronomy_8F90_source.html">astronomy.F90</a>.</p>

</div>
</div>
<a id="ga7fb404a6aa92465cf74a3fd4a5c48d37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7fb404a6aa92465cf74a3fd4a5c48d37">&#9670;&nbsp;</a></span>orbital_time()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real function, public astronomy_mod::orbital_time </td>
          <td>(</td>
          <td class="paramtype">type(time_type), intent(in)&#160;</td>
          <td class="paramname"><em>time</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Orbital time returns the time (1 year = 2*pi) since autumnal equinox. </p>
<p>Orbital time returns the time (1 year = 2*pi) since autumnal equinox; autumnal_eq_ref is a module variable of time_type and will have been defined by default or by a call to set_ref_date_of_ae; length_of_year is available through the time manager and is set at the value approriate for the calandar being used </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">time</td><td>time (1 year = 2*pi) since autumnal equinox </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="astronomy_8F90_source.html#l02205">2205</a> of file <a class="el" href="astronomy_8F90_source.html">astronomy.F90</a>.</p>

</div>
</div>
<a id="ga58ff2b69c33ae8d00c831b2b049e4573"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga58ff2b69c33ae8d00c831b2b049e4573">&#9670;&nbsp;</a></span>set_orbital_parameters()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public astronomy_mod::set_orbital_parameters </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>ecc_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>obliq_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>per_in</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>set_orbital_parameters saves the input values of eccentricity, obliquity and perihelion time as module variables for use by astronomy_mod. </p>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">FATAL,astronomy_mod module has not been initialized</td><td></td></tr>
    <tr><td class="paramname">FATAL,astronomy_mod ecc must be between 0 and 0.99</td><td></td></tr>
    <tr><td class="paramname">FATAL,astronomy_mod obliquity must be between -90. and 90. degrees</td><td></td></tr>
    <tr><td class="paramname">FATAL,astronomy_mod perihelion must be between 0.0 and 360. degrees</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ecc_in</td><td>Eccentricity of orbital ellipse [dimensionless] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">obliq_in</td><td>Obliquity [degrees] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">per_in</td><td>Longitude of perihelion with respect to autumnal equinox in northern hemisphere [degrees] </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="astronomy_8F90_source.html#l00609">609</a> of file <a class="el" href="astronomy_8F90_source.html">astronomy.F90</a>.</p>

</div>
</div>
<a id="ga58c5837e3f38565db2c7901d880950f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga58c5837e3f38565db2c7901d880950f7">&#9670;&nbsp;</a></span>set_ref_date_of_ae()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public astronomy_mod::set_ref_date_of_ae </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>day_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>month_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>year_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>second_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>minute_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>hour_in</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>set_ref_date_of_ae provides a means of specifying the reference date of the NH autumnal equinox for a particular year. </p>
<p>set_ref_date_of_ae provides a means of specifying the reference date of the NH autumnal equinox for a particular year. It is only used if calls are made to the calandar versions of the routines diurnal_solar and daily_mean_solar. If the NOLEAP calendar is used, then the date of autumnal equinox will be the same every year. If JULIAN is used, then the date of autumnal equinox will return to the same value every 4th year.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;day_in&gt;</td><td>Day of reference autumnal equinox </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;month_in&gt;</td><td>Month of reference autumnal equinox </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;year_in&gt;</td><td>Year of reference autumnal equinox </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;second_in&gt;</td><td>OPTIONAL: Second of reference autumnal equinox </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;minute_in&gt;</td><td>OPTIONAL: Minute of reference autumnal equinox </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;hour_in&gt;</td><td>OPTIONAL: Hour of reference autumnal equinox</td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">FATAL,astronomy_mod module has not been initialized</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="astronomy_8F90_source.html#l00708">708</a> of file <a class="el" href="astronomy_8F90_source.html">astronomy.F90</a>.</p>

</div>
</div>
<a id="gaa2cc4e0964e5251d056c4f05c4a8ddf7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa2cc4e0964e5251d056c4f05c4a8ddf7">&#9670;&nbsp;</a></span>universal_time()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real function, public astronomy_mod::universal_time </td>
          <td>(</td>
          <td class="paramtype">type(time_type), intent(in)&#160;</td>
          <td class="paramname"><em>time</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>universal_time returns the time of day at longitude = 0.0 (1 day = 2*pi) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">time</td><td>Time (1 year = 2*pi) since autumnal equinox </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="astronomy_8F90_source.html#l02220">2220</a> of file <a class="el" href="astronomy_8F90_source.html">astronomy.F90</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
