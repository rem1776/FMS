<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FMS: sat_vapor_pres_mod</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FMS
   &#160;<span id="projectnumber">2021.02.0</span>
   </div>
   <div id="projectbrief">Flexible Modeling System</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('group__sat__vapor__pres__mod.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">sat_vapor_pres_mod<div class="ingroups"><a class="el" href="group__sat__vapor__pres.html">Saturation Vapor Pressure</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Routines for computing the saturation vapor pressure (es), the specific humidity (qs) and vapor mixing ratio (mrs) Given a specified relative humidity, calculates es, qs, and mrs, as well as their derivatives with respect to temperature, and also includes routines to initialize the look-up table. This module contains routines for determining the saturation vapor pressure (<code>ES</code>) from lookup tables constructed using equations given in the Smithsonian tables. The <code>ES</code> lookup tables are valid between -160C and +100C (approx 113K to 373K).  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:ga5626e10c4062e4df895cd17618577e53"><td class="memItemLeft" align="right" valign="top"><a id="ga5626e10c4062e4df895cd17618577e53"></a>
subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><b>sat_vapor_pres_init</b> (err_msg)</td></tr>
<tr class="separator:ga5626e10c4062e4df895cd17618577e53"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ga00949932f281a245aafe2ccd66d9ef17"><td class="memItemLeft" align="right" valign="top"><a id="ga00949932f281a245aafe2ccd66d9ef17"></a>
integer, public&#160;</td><td class="memItemRight" valign="bottom"><b>tcmin</b> = -160</td></tr>
<tr class="separator:ga00949932f281a245aafe2ccd66d9ef17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga016aa2032c9e6beb71b8533566c897fc"><td class="memItemLeft" align="right" valign="top"><a id="ga016aa2032c9e6beb71b8533566c897fc"></a>
integer, public&#160;</td><td class="memItemRight" valign="bottom"><b>tcmax</b> = 100</td></tr>
<tr class="separator:ga016aa2032c9e6beb71b8533566c897fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Routines for computing the saturation vapor pressure (es), the specific humidity (qs) and vapor mixing ratio (mrs) Given a specified relative humidity, calculates es, qs, and mrs, as well as their derivatives with respect to temperature, and also includes routines to initialize the look-up table. This module contains routines for determining the saturation vapor pressure (<code>ES</code>) from lookup tables constructed using equations given in the Smithsonian tables. The <code>ES</code> lookup tables are valid between -160C and +100C (approx 113K to 373K). </p>
<p>The values of <code>ES</code> are computed over ice from -160C to -20C, over water from 0C to 100C, and a blended value (over water and ice) from -20C to 0C.</p>
<p>Routines are also included to calculate the saturation specific humidity and saturation mixing ratio for vapor, and their deriv- atives with respect to temperature. By default, the values returned are those at saturation; optionally, values of q and mr at a spec- ified relative humidity may instead be returned. Two forms are available; the approximate form that has been traditionally used in GCMs, and an exact form provided by SJ Lin in which saturation is reached while maintaining constant pressure and temperature.</p>
<p>This version was written for non-vector machines. See the &lt;LINK SRC="#NOTES"&gt;notes&lt;/LINK&gt; section for details on vectorization.</p>
<h2>arguments </h2>
<p>temp intent in temperature in degrees kelvin es intent out saturation vapor pressure in Pascals des intent out derivative of saturation vapor pressure with respect to temperature (Pascals/degree) press intent in atmospheric pressure in Pascals qs intent out specific humidity at relative humidity hc (kg(vapor) / kg(moist air) mrs intent out mixing ratio at relative humidity hc (kg(vapor) / kg(dry air)</p>
<h2>optional arguments </h2>
<p>q intent in vapor specific humidity (kg(vapor) / kg(moist air) hc intent in relative humidity at which output fields are desired: default is 100 % dqsdT intent out derivative of saturation specific humidity with respect to temperature (kg(vapor) / kg(moist air) /degree) mr intent in vapor mixing ratio (kg(vapor) / kg(dry air) dmrsdT intent out derivative of saturation mixing ratio with respect to temperature (kg(vapor) / kg(dry air) /degree) esat intent out saturation vapor pressure (Pascals) err_msg intent out character string to hold error message es_over_liq intent in use es table wrt liquid only</p>
<p>Example Usages: </p><pre class="fragment">         call lookup_es  (temp, es, err_msg)

         call lookup_des (temp, des, err_msg)

         call lookup_es_des (temp, es, des, err_msg)

         call lookup_es2 (temp, es, err_msg)

         call lookup_des2 (temp, des, err_msg)

         call lookup_es2_des2 (temp, es, des, err_msg)

         call compute_qs (temp, press, qs, q, hc, dqsdT, esat,
                          err_msg, es_over_liq)

         call compute_mrs (temp, press, mrs, mr, hc, dmrsdT, esat,
                           err_msg, es_over_liq)
</pre> 

<h3><a id="lookup_es"></a>lookup_es Interface</h3><div class="textblock">For the given temperatures, returns the saturation vapor pressuresFor the given temperatures these routines return the saturation vapor pressure(esat). The return values are derived from lookup tables. Example usage: </p><div class="fragment"><div class="line"><span class="keyword">call </span>lookup_es( temp, esat, err_msg ) </div>
</div><!-- fragment --><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">temp</td><td>Temperature in degrees Kelvin. </td></tr>
    <tr><td class="paramname">esat</td><td>Saturation vapor pressure in pascals. May be a scalar, 1d, 2d, or 3d array Must have the same order and size as temp. </td></tr>
    <tr><td class="paramname">err_msg</td><td>Character string containing error message to be returned to calling routine. </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">FATAL</td><td>table overflow, nbad=## Temperature(s) provided to the saturation vapor pressure lookup are outside the valid range of the lookup table (-160 to 100 deg C). This may be due to a numerical instability in the model. Information should have been printed to standard output to help determine where the instability may have occurred. If the lookup table needs a larger temperature range, then parameters in the module header must be modified. </td></tr>
  </table>
  </dd>
</dl>
</div>

<h3><a id="lookup_des"></a>lookup_des Interface</h3><div class="textblock">For the given temperatures, returns the derivative of saturation vapor pressure with respect to temperature.For the given temperatures these routines return the derivtive of esat w.r.t. temperature (desat). The return values are derived from lookup tables.<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">temp</td><td>Temperature in degrees kelvin </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">desat</td><td>Derivative of saturation vapor pressure w.r.t. temperature in pascals/degree. May be a scalar, 1d, 2d, or 3d array. Must have the same order and size as temp. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">err_msg</td><td>Character string containing error message to be returned to calling routine.</td></tr>
  </table>
  </dd>
</dl>
<p>@error FATAL table overflow, nbad=## Temperature(s) provided to the saturation vapor pressure lookup are outside the valid range of the lookup table (-160 to 100 deg C). This may be due to a numerical instability in the model. Information should have been printed to standard output to help determine where the instability may have occurred. If the lookup table needs a larger temperature range, then parameters in the module header must be modified.<br  />
Example usage: </p><div class="fragment"><div class="line"><span class="keyword">call </span>lookup_des( temp, desat) </div>
</div><!-- fragment --> </div>

<h3><a id="lookup_es_des"></a>lookup_es_des Interfaces</h3><div class="textblock">For the given temperatures, returns the saturation vapor pressure and the derivative of saturation vapor pressure with respect to temperature.For the given temperatures these routines return the saturation vapor pressure (esat) and the derivative of esat w.r.t temperature (desat). The return values are derived from lookup tables (see notes below).<br  />
Example usage: </p><div class="fragment"><div class="line"><span class="keyword">call </span>lookup_es_des( temp, esat, desat, err_msg ) </div>
</div><!-- fragment --><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">temp</td><td>Temperature in degrees Kelvin. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">esat</td><td>Saturation vapor pressure in pascals. May be a scalar, 1d, 2d, or 3d array. Must have the same order and size as temp. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">desat</td><td>Derivative of saturation vapor pressure w.r.t. temperature in pascals/degree. May be a scalar, 1d, 2d, or 3d array. Must have the same order and size as temp. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">err_msg</td><td>Character string containing error message to be returned to calling routine. @error FATAL table overflow, nbad=## Temperature(s) provided to the saturation vapor pressure lookup are outside the valid range of the lookup table (-160 to 100 deg C). This may be due to a numerical instability in the model. Information should have been printed to standard output to help determine where the instability may have occurred. If the lookup table needs a larger temperature range, then parameters in the module header must be modified. </td></tr>
  </table>
  </dd>
</dl>
</div>

<h3><a id="compute_qs"></a>compute_qs Interface</h3><div class="textblock">For the given temperatures, pressures and optionally vapor specific humidity, returns the specific humidity at saturation (optionally at relative humidity hc instead of at saturation) and optionally the derivative of saturation specific humidity w.r.t. temperature, and the saturation vapor pressure.For the input temperature and pressure these routines return the specific humidity (qsat) at saturation (unless optional argument hc is used to specify the relative humidity at which qsat should apply) and, if desired, the derivative of qsat w.r.t temperature (dqsdT) and / or the saturation vapor pressure (esat). If the optional input argument specific humidity (q) is present, the exact expression for qs is used; if q is not present the tradit- ional form (valid at saturation) is used. if the optional qsat derivative argument is present, the derivative of qsat w.r.t. temperature will also be returned, defined consistent with the expression used for qsat. The return values are derived from lookup tables (see notes below).Example usage: </p><div class="fragment"><div class="line"><span class="keyword">call </span>compute_qs( temp, press, qsat, q, hc, dqsdt, esat, err_msg ) </div>
</div><!-- fragment --> </div>

<h3><a id="compute_mrs"></a>compute_mrs Interface</h3><div class="textblock">For the given temperatures, pressures and optionally vapor mixing ratio, returns the vapor mixing ratio at saturation (optionally at relative humidity hc instead of at saturation) and optionally the derivative of saturation vapor mixing ratio w.r.t. temperature, and the saturation vapor pressure.For the input temperature and pressure these routines return the vapor mixing ratio (mrsat) at saturation (unless optional argument hc is used to specify the relative humidity at which mrsat should apply) and, if desired, the derivative of mrsat w.r.t temperature (dmrsdT) and / or the saturation vapor pressure (esat). If the optional input argument specific humidity (mr) is present, the exact expression for mrs is used; if qr is not present the tradit- ional form (valid at saturation) is used. if the optional mrsat derivative argument is present, the derivative of mrsat w.r.t. temperature will also be returned, defined consistent with the expression used for mrsat. The return values are derived from lookup tables (see notes below).<br  />
Example usage: </p><div class="fragment"><div class="line"><span class="keyword">call </span>compute_mrs( temp, press, mrsat, mr, hc, dmrsdt, esat,</div>
<div class="line">                      err_msg ) </div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
